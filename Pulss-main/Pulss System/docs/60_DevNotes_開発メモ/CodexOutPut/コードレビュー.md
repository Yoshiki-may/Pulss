# コードレビュー（Pulss-main）

## 重大な懸念
- 文字化けが全体に発生: `App.tsx`, `components/ClientDetails/*`, `components/SnsNews/SnsNewsPage.tsx`, `components/Schedule/SchedulePage.tsx`, `services/clientService.ts` などで日本語ラベル/アラートが cp932 由来の文字化け。UI が読めず、アラートも意味不明なため致命的な UX 欠陥。UTF-8 で再入力が必要。
- 実データ経路が未実装: `services/clientService.ts` はすべてモックで、n8n の POST 先 `/api/sns-news` も存在しない。現状はデモ表示のみで、ワークフローの本番検証ができない。

## 高
- 配信方法の不一致: `index.html` で Tailwind CDN と React/Lucide の importmap を読み込んでおり、Vite バンドルと二重管理になる。ネットワークに依存し、パフォーマンス/セキュリティ面で本番非推奨。Tailwind はビルド済み CSS に統一し、importmap は削除するのが安全。
- ID 生成と永続化の欠如: `clientService.createClient` で `Math.random()` に頼っており衝突リスクあり。メモリ保持のみでページリロードで消失するため、少なくとも UUID 生成とサーバ保存を行うべき。
- クリップボード操作のフォールバックなし: `components/ClientDetails/ClientDetail.tsx` は `navigator.clipboard` を直接呼ぶが、HTTP/非対応ブラウザでは失敗する。`try/catch` と代替表示が必要。

## 中
- ニュース/業種タグの判定が不安定: `components/ClientDetails/SnsNewsWidget.tsx` で `toLowerCase()` + 部分一致だが、文字化けした業種文字列や日本語表記に弱い。定義済み enum をサーバから返す形にした方が安定。
- ランダムデータでグラフが揺れる: `clientService.getClientImpressions` が毎回乱数を返すため、グラフがリロードで揺れてしまう。API から安定した値を取得するか固定モックにする。
- アラート/ダイアログが文字化け・未翻訳: `alert`/`confirm` の文言が読めない状態。可視性とアクセシビリティの観点で修正必須。

## 残課題・質問
- FastAPI の API 仕様（ニュース保存・取得・クライアント/スケジュール CRUD）のインタフェースはいつ確定するか？`types.ts` をベースに DTO を固めたい。
- 認証/認可は不要か？n8n とフロントから直接叩く場合は最低限のトークン検証や Basic 認証を入れたい。
- インフラは EC2 シングル構成で良いか？n8n/バックエンド/フロントのプロセスを systemd + Nginx でまとめる運用を想定してよいか。
