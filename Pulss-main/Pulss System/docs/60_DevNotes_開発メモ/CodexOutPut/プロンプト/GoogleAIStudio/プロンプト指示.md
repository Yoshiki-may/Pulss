あなたはUI/UXを考慮できるダッシュボード開発エンジニアのスペシャリストです  
以下の要件定義書をもとに作成を開始してください

# パルスチャット連携クライアント管理ダッシュボード

要件定義書（MVP） v1.0

対象読者:

- フロントエンドエンジニア（React / Next.js / TypeScript）
    
- バックエンドエンジニア（Python / FastAPI想定）
    

---

## 1. システム概要

### 1.1 目的

- 営業・ディレクターの「ヒアリング力」をテンプレ化し、  
    **誰が担当しても一定以上のヒアリングができる状態**を作る:contentReference[oaicite:3]{index=3}。
    
- パルスチャット（AIヒアリング）で集めた情報を  
    **ダッシュボードで一元管理**し、成約前〜成約後の起点データとする:contentReference[oaicite:4]{index=4}。
    

### 1.2 対象範囲（MVP）

- クライアント管理ダッシュボード（社内用）
    
    - クライアント一覧（成約前／成約済み）
        
    - クライアント詳細（基本情報＋パルス要件レポート）
        
- パルスチャット連携
    
    - 会社IDに紐づくパルスチャットURL発行
        
    - パルス回答の受信（n8n経由）と要件レポート表示
        
- 通知（最低限）
    
    - 「パルス回答が登録された」Slack通知を想定:contentReference[oaicite:5]{index=5}
        

将来機能（KPIダッシュボード、コンテンツ管理、クライアント向け画面など）は  
**MVPのスコープ外**だが、拡張を前提として設計する:contentReference[oaicite:6]{index=6}。

---

## 2. 非機能要件（ざっくり）

- 同時利用: 社内ユーザー 50名＋クライアント500名想定:contentReference[oaicite:7]{index=7}
    
- 応答時間: 一般的な画面操作で 2秒以内を目安
    
- 通信: 全てHTTPS/TLS
    
- 認証: MVPでは社内ログインのみ（シンプルなID/PWでOK、将来RBACを導入予定）
    
- インフラ想定:
    
    - AWS EC2 or Lightsail 上で
        
        - Front: Next.js アプリ
            
        - Back: FastAPI
            
        - n8n: 別コンテナ or 別サーバ
            
    - DB: RDS(PostgreSQL) などRDB系
        

---

## 3. 全体アーキテクチャ

codeCode

```
[ブラウザ] ─────→ [Next.js Frontend] ─────→ [FastAPI Backend] ──→ [DB]

                       ↑                                     ↑
                       │                                     │
      （将来）SNS API   │                      [n8n] ──→ /api/pulse-responses
                       │
                営業・ディレクターが利用

[パルスチャットUI（フォーム/GPTs）]
    ↓ POST
[n8n Webhook] → OpenAI等でサマリ生成 → BackendへPOST


4. 画面要件
4.1 画面一覧

ログイン画面（簡易）

メインダッシュボード

左ペイン：クライアント一覧

右ペイン：クライアント詳細ビュー

以降は「メインダッシュボード」にフォーカスする。

4.2 メインダッシュボード レイアウト
4.2.1 左ペイン：クライアント一覧

表示要素

ステータスタブ:

「成約前」「成約済み」

業種フィルタ（Select or Tag）

検索ボックス（会社名 / メモを部分一致）

クライアントリスト（スクロール可能）

行項目:

会社名

業種

ステータスアイコン（成約前/成約済）

パルス回答有無（アイコン or バッジ）

ユーザーアクション

行クリック → 右ペインに詳細表示

「＋新規クライアント」ボタン → モーダル／右ペインで編集フォーム

4.2.2 右ペイン：クライアント詳細

上部: 基本情報

会社名

業種

ステータス（成約前/成約済）＋変更ボタン

担当営業、担当ディレクター

SlackチャンネルURL（クリックで別タブオープン）

メモ

中央: パルス要件レポート（読み取り専用）

セクション例：

クライアントの課題・やりたいこと

現状のSNS運用

想定ターゲット・ゴール

参考アカウント／参考動画リンク

下部: 操作

「パルスURL発行」ボタン

生成されたURLをコピーするUI（コピーアイコン）

5. データモデリング
5.1 ER 図（テキストイメージ）
Client (1) ──── (N) PulseResponse
Client (1) ──── (N) PulseLink (任意/MVPでは1件でも可)

5.2 テーブル定義（初期案）
5.2.1 clients テーブル
カラム名	型	必須	説明
id	UUID / int	✓	会社ID（主キー）
name	varchar	✓	会社名
industry	varchar	✓	業種（焼肉 / 美容など）
status	varchar	✓	'pre_contract' / 'contracted'
sales_owner	varchar	-	営業担当名
director_owner	varchar	-	ディレクター担当名
slack_url	varchar	-	SlackチャンネルURL
memo	text	-	社内メモ
created_at	timestamp	✓	作成日時
updated_at	timestamp	✓	更新日時
5.2.2 pulse_responses テーブル
カラム名	型	必須	説明
id	UUID/int	✓	回答ID（主キー）
client_id	UUID/int	✓	clients.id へのFK
problem	text	-	クライアントの課題・要望サマリ
current_sns	text	-	現状SNS運用サマリ
target	text	-	想定ターゲット・ゴールサマリ
reference_accounts	text	-	参考アカウントURLリスト（JSON可）
raw_payload	json	-	元の回答データ（バックアップ用）
submitted_at	timestamp	✓	回答日時

※ クライアントごとに「最新1件」を使う運用でOK（履歴はあっても良い）

5.2.3 pulse_links テーブル（必要なら）
カラム名	型	必須	説明
id	UUID/int	✓	主キー
client_id	UUID/int	✓	clients.id へのFK
token	varchar	✓	URL用トークン（ランダム文字列）
expires_at	timestamp	-	有効期限（MVPではnullでも可）
created_at	timestamp	✓	発行日時
6. API 要件（FastAPI 想定）

ベースURL: /api

6.1 クライアント関連
6.1.1 GET /clients

概要: クライアント一覧取得

クエリ:

status (optional) : 'pre_contract' / 'contracted'

industry (optional)

q (optional) : 検索文字列

レスポンス例:

[
  {
    "id": 1,
    "name": "焼肉A",
    "industry": "飲食",
    "status": "contracted",
    "has_pulse_response": true
  }
]

6.1.2 POST /clients

概要: クライアント新規作成

リクエスト:
{
  "name": "焼肉A",
  "industry": "飲食",
  "status": "pre_contract",
  "sales_owner": "営業A",
  "director_owner": "ディレクターB",
  "slack_url": "https://...",
  "memo": "メモ"
}

レスポンス: 作成されたclientオブジェクト

6.1.3 GET /clients/{id}

概要: クライアント詳細

レスポンス例:

{
  "id": 1,
  "name": "焼肉A",
  "industry": "飲食",
  "status": "pre_contract",
  "sales_owner": "営業A",
  "director_owner": "ディレクターB",
  "slack_url": "https://...",
  "memo": "メモ",
  "latest_pulse_response": {
    "problem": "集客が不安定",
    "current_sns": "Instagramを週3投稿",
    "target": "20〜30代のカップル",
    "reference_accounts": [
      "https://instagram.com/xxx"
    ],
    "submitted_at": "2025-12-01T12:00:00"
  }
}


6.1.4 PUT /clients/{id}

概要: クライアント情報更新（ステータス変更含む）

6.2 パルスURL関連
6.2.1 POST /clients/{id}/pulse-link

概要: 指定クライアント向けのパルスURLトークンを発行

処理:

pulse_links にレコードを作成（既存があれば再利用でも可）

URLテンプレート例: https://pulse.example.com/form?token={token}

実際のフォームはGoogleフォーム/GPTsなど

レスポンス:
{
  "url": "https://pulse.example.com/form?token=xxxxx"
}

6.3 パルス回答受信（n8n → Backend）
6.3.1 POST /pulse-responses

概要: n8nからのサマリ結果を受信して保存

送信元: n8n（パルスフォーム→n8n→Backend）

リクエスト例:

{
  "token": "xxxxx", 
  "problem": "課題サマリ…",
  "current_sns": "現状サマリ…",
  "target": "ターゲットサマリ…",
  "reference_accounts": [
    "https://instagram.com/aaa",
    "https://instagram.com/bbb"
  ],
  "raw_payload": {
    "q1": "xxxxx",
    "q2": "yyyyy"
  }
}

処理:

token から pulse_links を検索 → client_id を特定

pulse_responses にINSERT

レスポンス:

{ "status": "ok" }


7. フロント実装方針（Next.js + TypeScript）
7.1 ディレクトリ例

/src
  /app or /pages
    /login
    /dashboard
  /components
    /layout
      Sidebar.tsx
      MainLayout.tsx
    /clients
      ClientList.tsx
      ClientDetail.tsx
  /lib
    apiClient.ts
    types.ts

7.2 型定義（例）

// /lib/types.ts
export type ClientStatus = 'pre_contract' | 'contracted';

export interface ClientSummary {
  id: number;
  name: string;
  industry: string;
  status: ClientStatus;
  has_pulse_response: boolean;
}

export interface PulseResponse {
  problem: string;
  current_sns: string;
  target: string;
  reference_accounts: string[];
  submitted_at: string;
}

export interface ClientDetail extends ClientSummary {
  sales_owner?: string;
  director_owner?: string;
  slack_url?: string;
  memo?: string;
  latest_pulse_response?: PulseResponse;
}

8. 実装の進め方（作成手順）
スキル前提

フロント: React / Next.js / TypeScript

バックエンド: Python（FastAPIを想定）

推奨の進め方（ステップ順）
STEP 1: バックエンドの土台 & DBスキーマ

FastAPI プロジェクト作成

/health エンドポイントを作り、ブラウザ or curlで疎通確認。

DBマイグレーションツール導入（Alembicなど）

clients / pulse_responses / pulse_links テーブルを定義・マイグレーション実行。

ローカルで簡易データをINSERTし、SQLクエリで正しく取得できることを確認。

ここまでで「DB & APIの最小骨格」を固める。

STEP 2: クライアントAPI（CRUD）の実装

/api/clients GET/POST

/api/clients/{id} GET/PUT

返却JSONを 型定義（TypeScript）を意識した形 に固定する。

自分用の簡単なAPIテスト（pytest + httpx or curl/Postman）を書くと後が楽。

STEP 3: フロントのレイアウト & ダミーデータ

Next.js プロジェクト作成（app router or pages、どちらでもOK）

/dashboard ページに以下を実装:

左：サイドバー（ダミーのクライアントリスト）

右：詳細エリア（仮のモックデータ表示）

この段階では APIをまだ呼ばず、ハードコードのダミーデータでUIだけ作る。

「UIのイメージ」と「操作感」を先に固める。

STEP 4: フロントとバックエンドの接続

fetch or Axiosで /api/clients を叩き、左ペインのリストをAPI連携。

行クリックで /api/clients/{id} を叩き、右ペインに詳細表示。

ステータスフィルタ・検索ボックスをクエリパラメータと連動させる。

STEP 5: パルスURL発行フロー

バックエンドに /clients/{id}/pulse-link を実装。

トークン生成 → pulse_links 保存 → URL返却。

フロント右ペインに「パルスURL発行」ボタンを実装。

クリック → API呼び出し → 返ってきたURLをコピー可能に表示。

STEP 6: n8n連携用エンドポイント（/pulse-responses）

/pulse-responses POSTを実装。

token → pulse_links → client_id の解決

pulse_responses へのINSERT

一旦は curl などで手動POSTし、動作を確認。

確認後、n8n側で

Webhook → OpenAI処理 → Backend POST
のワークフローを組む。

STEP 7: レポート表示の最終調整

クライアント詳細APIで latest_pulse_response を返すようにする。

フロント右ペインで、セクションごとに見やすく表示。

「回答がない場合」はプレースホルダ（例：グレー文字）を表示。

STEP 8: 最低限のエラー処理・認証

404/500エラー時のレスポンス形式を決める。

環境変数の管理（DB URL、CORS設定など）。

MVPとしての簡易ログイン（Basic認証やセッションなど、最小限）。
```