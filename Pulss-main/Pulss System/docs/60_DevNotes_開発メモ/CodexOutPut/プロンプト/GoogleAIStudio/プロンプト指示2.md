要件定義書に追記でSNSニュースモジュールを組み込んでもらいます  
下記の内容にそって開発してください  
その際、現在のフロントのデザインを崩さないように作成してください

要件定義書への追記（10章として追加）

## 10. SNSニュースモジュール（追加機能）

### 10.1 目的

- SNSマーケティング全般（Instagram, TikTok, YouTube, X など）の最新ニュースを  
    **ダッシュボードからすぐ確認できる状態**を作る。
    
- 営業・ディレクター・CSが、提案や戦略検討の前に  
    「最近のSNSトレンド」「アルゴリズム変更」「事例記事」などを素早くキャッチアップできるようにする。
    
- 既存のニュースアプリは一旦リセットし、**今回のダッシュボード用に1から作り直す**。:contentReference[oaicite:0]{index=0}
    

---

### 10.2 ユースケース

1. **営業・ディレクターの事前調査**
    
    - 商談前や定例前にダッシュボードの「SNSニュース」画面を開き、  
        直近15件のSNSマーケ関連ニュースをざっと確認する。
        
    - 気になるニュースをクリックして、外部サイトで詳細を読む。
        
2. **クライアント業種に近いニュースの確認**
    
    - クライアント詳細画面のウィジェットから、そのクライアントの業種（例：飲食、美容）に紐づくニュースだけを簡易表示する。
        
    - 例：美容クリニック案件の場合、美容・コスメ系のSNSマーケ記事を中心に表示。
        
3. **プラットフォーム別のトレンド確認**
    
    - 「Instagram」「TikTok」「YouTube」「X」などでフィルタし、  
        そのプラットフォームに関するニュースだけを確認する。
        

---

### 10.3 画面仕様（MVP）

#### 10.3.1 配置

1. **SNSニュース専用画面**
    
    - ダッシュボードの上部ナビ or 左メニューに「SNSニュース」メニューを追加。
        
    - /sns-news に遷移するとニュース一覧をフル幅表示。
        
2. **クライアント詳細画面内ウィジェット**
    
    - クライアント詳細ビュー（右ペイン）の下部に  
        「SNSニュース（この業種向け）」ウィジェットを配置。
        
    - 業種に紐づくニュースを **最新5件のみ** 簡易表示。
        
    - 「もっと見る」リンクで /sns-news に遷移し、全件を閲覧できる。
        

#### 10.3.2 SNSニュース一覧画面（/sns-news）

- 表示要素：
    
    - フィルタバー：
        
        - プラットフォーム：All / Instagram / TikTok / YouTube / X / その他
            
        - 業種：All / 飲食 / 美容 / ホテル / その他（内部的には food / beauty / hotel / other などのコードにマッピング）
            
    - ニュースカード一覧（縦リスト or グリッド）
        
        - タイトル
            
        - 要約（OpenAIで生成：100〜200文字程度）
            
        - プラットフォームタグ（例：Instagram, TikTok）
            
        - 業種タグ（例：food, beauty）
            
        - ソース名（Google News / RSS媒体名など）
            
        - 投稿日時（published_at）
            
        - 「外部リンクで開く」ボタン（新規タブ）
            
- 挙動：
    
    - 画面表示時は、**直近30日以内かつ最新15件** を取得（GET /api/sns-news?limit=15）。
        
    - フィルタを変更した場合はクエリパラメータ付きで再取得（例：?platform=instagram&industry=beauty）。
        

#### 10.3.3 クライアント詳細内ウィジェット

- 表示要素：
    
    - 見出し：「この業種向けSNSニュース（最新5件）」
        
    - リスト：
        
        - タイトル（1行）
            
        - プラットフォームタグ
            
        - 投稿日時
            
- 挙動：
    
    - クライアントの industry を内部コード（例：food / beauty）にマッピングし、  
        GET /api/sns-news?industry=food&limit=5 のように呼び出す。
        
    - タイトルクリックで /sns-news 画面に遷移（そのフィルタ状態にしてもよい）。
        

---

### 10.4 データモデル（SNSニュース）

#### 10.4.1 テーブル：sns_news_items

|   |   |   |   |
|---|---|---|---|
|カラム名|型|必須|説明|
|id|UUID/int|✓|ニュースID（主キー）|
|title|varchar|✓|記事タイトル|
|summary|text|✓|OpenAIで生成した要約文（100〜200文字を目安）|
|url|varchar|✓|記事URL（外部ニュースサイト）|
|platform_tags|varchar|-|「instagram,tiktok」のようなカンマ区切り文字列|
|industry_tags|varchar|-|「food,beauty」などの業種タグ（将来の精度向上も想定）|
|source_name|varchar|-|媒体名（例：Google News、特定ブログ名等）|
|source_type|varchar|-|'rss' / 'google_news' / 'manual' など|
|published_at|timestamp|-|記事の公開日時（取得できない場合はnull可）|
|fetched_at|timestamp|✓|ニュースを取得した日時|
|created_at|timestamp|✓|レコード作成日時|

- **保存方針**：
    
    - 原則、**直近30日分のみを保持**する。
        
    - バックエンド or n8nで定期的に「30日より前のレコードを削除」するジョブを実行。
        
    - フロント側の一覧画面では、デフォルトで最新15件を取得する。
        

---

### 10.5 API仕様（Backend / FastAPI）

ベースURL: /api/sns-news

#### 10.5.1 GET /api/sns-news

- 概要：SNSニュース一覧取得（ダッシュボード表示用）
    
- クエリパラメータ：
    
    - platform（任意）：instagram | tiktok | youtube | x | other | all
        
    - industry（任意）：food | beauty | hotel | other | all
        
    - limit（任意）：デフォルト15、最大30
        
- 振る舞い：
    
    - 取得対象は常に「created_at or fetched_at が直近30日以内」のレコード。
        
    - platform_tags / industry_tags による部分一致でフィルタリング。
        
- レスポンス例：
    

codeJSON

```
[
  {
    "id": 1,
    "title": "Instagramリールの新アルゴリズム変更",
    "summary": "Instagramがリールの表示ロジックを変更し、保存・シェアの重要度が…",
    "url": "https://example.com/news/1",
    "platform_tags": ["instagram"],
    "industry_tags": ["food", "beauty"],
    "source_name": "Google News",
    "source_type": "google_news",
    "published_at": "2025-12-01T10:00:00",
    "fetched_at": "2025-12-01T11:00:00"
  }
]
10.5.2 POST /api/sns-news/bulk（n8n向け）

概要：n8nからニュースをまとめて登録・更新するためのエンドポイント。

リクエスト例：
{
  "items": [
    {
      "title": "...",
      "summary": "OpenAIで生成した要約文...",
      "url": "https://example.com/...",
      "platform_tags": ["instagram"],
      "industry_tags": ["food"],
      "source_name": "Google News",
      "source_type": "google_news",
      "published_at": "2025-12-01T10:00:00"
    }
  ]
}

振る舞い：

url をキーとして既存レコードがあれば UPDATE、なければ INSERT。

summary は n8n側で OpenAI から生成済みのテキストをそのまま保存。

※ 「1件ずつ登録」のほうが実装しやすければ POST /api/sns-news でも構わない（実装時に選択）。

10.6 n8n ワークフロー（概要）

トリガー

Cron（例：毎日 3回）で起動。

ニュース取得

Google News / RSS などから「SNSマーケ全般」に関する記事を取得。

検索キーワード例：Instagram リール, TikTok マーケティング, SNS アルゴリズム など。

OpenAIによる要約生成

n8nの OpenAI ノードで、各記事の title + description（あれば） を渡し、

日本語で

100〜200文字程度

「ビジネス向け・提案に転用しやすいトーン」
で要約を生成。

タグ付け（簡易）

タイトルや本文に含まれるキーワードで、

プラットフォームタグ（instagram / tiktok etc）

業種タグ（food / beauty / hotel / other）
を簡易的に判定し、配列として付与。

バックエンドへ送信

POST /api/sns-news/bulk に要約済みデータを送る。

古いデータの削除（任意）

別ワークフロー or バックエンドのバッチで
「30日より前の sns_news_items を削除」。

10.7 実装の進め方（SNSニュース周りのSTEP）

既存の実装手順（STEP1〜STEP8）に続けて、SNSニュース用のSTEP9を追加する。

STEP 9: SNSニュースモジュールの実装

DBスキーマ追加

sns_news_items テーブルを追加し、マイグレーションを実行。

バックエンドAPI実装

GET /api/sns-news（フィルタ＋limit付き）

POST /api/sns-news/bulk（n8n用）

単体テスト or 簡易動作確認（curl / HTTPクライアント）を用意。

フロント /sns-news ページ作成

まずは ダミーデータでカードUI＋フィルタバー を作る。

その後 GET /api/sns-news と接続して実データ表示に切り替える。

クライアント詳細画面のウィジェット

右ペイン下部に「この業種向けSNSニュース」を表示。

クライアントの industry を food / beauty などにマッピングし、
GET /api/sns-news?industry=food&limit=5 で取得して表示。

n8nフロー構築

開発環境でニュース取得フロー＋OpenAI要約を作成。

POST /api/sns-news/bulk に送信し、DBにニュースがたまることを確認。

挙動確認

/sns-news にニュースが出ること

クライアント詳細ウィジェットが業種別ニュースを表示すること

30日を越えたデータが定期的に削除されること（削除フローが動作しているか）
```